#!/bin/bash
#SBATCH --job-name=bl_deepsea_specific_col_1_2
#SBATCH --mail-type=FAIL
#SBATCH --mail-user=tlin@nygenome.org
#SBATCH --mem=450G
#SBATCH --time=05:00:00
#SBATCH --output=output/bl_deepsea/log/%x_%j.log


cd ~/polyfun

source /gpfs/commons/groups/knowles_lab/software/anaconda3/bin/activate
conda activate polyfun

summary_stats='/gpfs/commons/groups/knowles_lab/data/ADSP_reguloML/summary_stats/alzheimers/kunkle_2019/AD_Kunkle_etal_Stage1.parquet'
bl='/gpfs/commons/groups/knowles_lab/data/ldsc/polyfun/baselineLF2.2.UKB'

deepsea='/gpfs/commons.home/tlin/polyfun/data/deepsea/depsea_all_anno'
python polyfun.py \
  --compute-h2-L2 \
  --output-prefix output/bl_deepsea/${col_name}/bl_deepsea_${col_name} \
  --sumstats $summary_stats \
  --ref-ld-chr $bl/baselineLF2.2.UKB.,/gpfs/commons/groups/knowles_lab/data/ADSP_reguloML/annotations/expecto_annotations/annotations_combined_ukb/split/$enhancer/expecto_${enhancer}_ \
  --w-ld-chr $bl/weights.UKB. \
  --allow-missing \
  --anno Coding_UCSC_lowfreq,Coding_UCSC_common,Coding_UCSC.flanking.500_lowfreq,Coding_UCSC.flanking.500_common,Conserved_LindbladToh_lowfreq,Conserved_LindbladToh_common,Conserved_LindbladToh.flanking.500_lowfreq,Conserved_LindbladToh.flanking.500_common,CTCF_Hoffman_lowfreq,CTCF_Hoffman_common,CTCF_Hoffman.flanking.500_lowfreq,CTCF_Hoffman.flanking.500_common,DGF_ENCODE_lowfreq,DGF_ENCODE_common,DGF_ENCODE.flanking.500_lowfreq,DGF_ENCODE.flanking.500_common,DHS_peaks_Trynka_lowfreq,DHS_peaks_Trynka_common,DHS_Trynka_lowfreq,DHS_Trynka_common,DHS_Trynka.flanking.500_lowfreq,DHS_Trynka.flanking.500_common,Enhancer_Andersson_lowfreq,Enhancer_Andersson_common,Enhancer_Andersson.flanking.500_lowfreq,Enhancer_Andersson.flanking.500_common,Enhancer_Hoffman_lowfreq,Enhancer_Hoffman_common,Enhancer_Hoffman.flanking.500_lowfreq,Enhancer_Hoffman.flanking.500_common,FetalDHS_Trynka_lowfreq,FetalDHS_Trynka_common,FetalDHS_Trynka.flanking.500_lowfreq,FetalDHS_Trynka.flanking.500_common,H3K27ac_Hnisz_lowfreq,H3K27ac_Hnisz_common,H3K27ac_Hnisz.flanking.500_lowfreq,H3K27ac_Hnisz.flanking.500_common,H3K27ac_PGC2_lowfreq,H3K27ac_PGC2_common,H3K27ac_PGC2.flanking.500_lowfreq,H3K27ac_PGC2.flanking.500_common,H3K4me1_peaks_Trynka_lowfreq,H3K4me1_peaks_Trynka_common,H3K4me1_Trynka_lowfreq,H3K4me1_Trynka_common,H3K4me1_Trynka.flanking.500_lowfreq,H3K4me1_Trynka.flanking.500_common,H3K4me3_peaks_Trynka_lowfreq,H3K4me3_peaks_Trynka_common,H3K4me3_Trynka_lowfreq,H3K4me3_Trynka_common,H3K4me3_Trynka.flanking.500_lowfreq,H3K4me3_Trynka.flanking.500_common,H3K9ac_peaks_Trynka_lowfreq,H3K9ac_peaks_Trynka_common,H3K9ac_Trynka_lowfreq,H3K9ac_Trynka_common,H3K9ac_Trynka.flanking.500_lowfreq,H3K9ac_Trynka.flanking.500_common,Intron_UCSC_lowfreq,Intron_UCSC_common,Intron_UCSC.flanking.500_lowfreq,Intron_UCSC.flanking.500_common,PromoterFlanking_Hoffman_lowfreq,PromoterFlanking_Hoffman_common,PromoterFlanking_Hoffman.flanking.500_lowfreq,PromoterFlanking_Hoffman.flanking.500_common,Promoter_UCSC_lowfreq,Promoter_UCSC_common,Promoter_UCSC.flanking.500_lowfreq,Promoter_UCSC.flanking.500_common,Repressed_Hoffman_lowfreq,Repressed_Hoffman_common,Repressed_Hoffman.flanking.500_lowfreq,Repressed_Hoffman.flanking.500_common,SuperEnhancer_Hnisz_lowfreq,SuperEnhancer_Hnisz_common,SuperEnhancer_Hnisz.flanking.500_lowfreq,SuperEnhancer_Hnisz.flanking.500_common,TFBS_ENCODE_lowfreq,TFBS_ENCODE_common,TFBS_ENCODE.flanking.500_lowfreq,TFBS_ENCODE.flanking.500_common,Transcr_Hoffman_lowfreq,Transcr_Hoffman_common,Transcr_Hoffman.flanking.500_lowfreq,Transcr_Hoffman.flanking.500_common,TSS_Hoffman_lowfreq,TSS_Hoffman_common,TSS_Hoffman.flanking.500_lowfreq,TSS_Hoffman.flanking.500_common,UTR_3_UCSC_lowfreq,UTR_3_UCSC_common,UTR_3_UCSC.flanking.500_lowfreq,UTR_3_UCSC.flanking.500_common,UTR_5_UCSC_lowfreq,UTR_5_UCSC_common,UTR_5_UCSC.flanking.500_lowfreq,UTR_5_UCSC.flanking.500_common,WeakEnhancer_Hoffman_lowfreq,WeakEnhancer_Hoffman_common,WeakEnhancer_Hoffman.flanking.500_lowfreq,WeakEnhancer_Hoffman.flanking.500_common,GERP.NS_lowfreq,GERP.NS_common,GERP.RSsup4_lowfreq,GERP.RSsup4_common,MAFbin_lowfreq_1,MAFbin_lowfreq_2,MAFbin_lowfreq_3,MAFbin_lowfreq_4,MAFbin_lowfreq_5,MAFbin_lowfreq_6,MAFbin_lowfreq_7,MAFbin_lowfreq_8,MAFbin_lowfreq_9,MAFbin_lowfreq_10,MAFbin_frequent_1,MAFbin_frequent_2,MAFbin_frequent_3,MAFbin_frequent_4,MAFbin_frequent_5,MAFbin_frequent_6,MAFbin_frequent_7,MAFbin_frequent_8,MAFbin_frequent_9,MAFbin_frequent_10,MAF_Adj_Predicted_Allele_Age_common,MAF_Adj_LLD_AFR_lowfreq,MAF_Adj_LLD_AFR_common,Recomb_Rate_10kb_lowfreq,Recomb_Rate_10kb_common,Nucleotide_Diversity_10kb_lowfreq,Nucleotide_Diversity_10kb_common,Backgrd_Selection_Stat_lowfreq,Backgrd_Selection_Stat_common,CpG_Content_50kb_lowfreq,CpG_Content_50kb_common,MAF_Adj_ASMC_lowfreq,MAF_Adj_ASMC_common,GTEx_eQTL_MaxCPP_common,BLUEPRINT_H3K27acQTL_MaxCPP_common,BLUEPRINT_H3K4me1QTL_MaxCPP_common,BLUEPRINT_DNA_methylation_MaxCPP_common,synonymous_lowfreq,synonymous_common,non_synonymous_lowfreq,non_synonymous_common,Conserved_Vertebrate_phastCons46way_lowfreq,Conserved_Vertebrate_phastCons46way_common,Conserved_Vertebrate_phastCons46way.flanking.500_lowfreq,Conserved_Vertebrate_phastCons46way.flanking.500_common,Conserved_Mammal_phastCons46way_lowfreq,Conserved_Mammal_phastCons46way_common,Conserved_Mammal_phastCons46way.flanking.500_lowfreq,Conserved_Mammal_phastCons46way.flanking.500_common,Conserved_Primate_phastCons46way_lowfreq,Conserved_Primate_phastCons46way_common,Conserved_Primate_phastCons46way.flanking.500_lowfreq,Conserved_Primate_phastCons46way.flanking.500_common,BivFlnk_lowfreq,BivFlnk_common,BivFlnk.flanking.500_lowfreq,BivFlnk.flanking.500_common,Human_Promoter_Villar_lowfreq,Human_Promoter_Villar_common,Human_Promoter_Villar.flanking.500_lowfreq,Human_Promoter_Villar.flanking.500_common,Human_Enhancer_Villar_lowfreq,Human_Enhancer_Villar_common,Human_Enhancer_Villar.flanking.500_lowfreq,Human_Enhancer_Villar.flanking.500_common,Ancient_Sequence_Age_Human_Promoter_lowfreq,Ancient_Sequence_Age_Human_Promoter_common,Ancient_Sequence_Age_Human_Promoter.flanking.500_lowfreq,Ancient_Sequence_Age_Human_Promoter.flanking.500_common,Ancient_Sequence_Age_Human_Enhancer_lowfreq,Ancient_Sequence_Age_Human_Enhancer_common,Ancient_Sequence_Age_Human_Enhancer.flanking.500_lowfreq,Ancient_Sequence_Age_Human_Enhancer.flanking.500_common,Human_Enhancer_Villar_Species_Enhancer_Count_lowfreq,Human_Enhancer_Villar_Species_Enhancer_Count_common,Human_Promoter_Villar_ExAC_lowfreq,Human_Promoter_Villar_ExAC_common,Human_Promoter_Villar_ExAC.flanking.500_lowfreq,Human_Promoter_Villar_ExAC.flanking.500_common,${col}
		

